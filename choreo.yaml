name: webgenie-backend
version: 1.0.0
type: service

build:
  dockerfile: Dockerfile
  context: .

deploy:
  replicaCount: 1
  env:
    - name: ENVIRONMENT
      value: "production"
    - name: WEBGENIE_LOG_DIR
      value: "/var/log/webgenie"

  container:
    ports:
      - name: http
        containerPort: 8000

  ingress:
    enabled: true
    type: Public
    paths:
      - path: /
        pathType: Prefix
        backend:
          port: http

  autoscaling:
    minReplicas: 1
    maxReplicas: 3
    cpu:
      targetAverageUtilization: 70

  livenessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 10
    periodSeconds: 10

  readinessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5

